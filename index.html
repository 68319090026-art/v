<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞ Viewvi</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root { --neon-blue: #00f2ff; --neon-green: #39ff14; --neon-red: #ff0055; }
        body { 
            font-family: 'Kanit', sans-serif; 
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1920&q=80');
            background-size: cover; background-attachment: fixed; margin: 0; padding: 20px; color: #fff;
        }
        .dashboard {
            background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(15px);
            border-radius: 30px; padding: 30px; max-width: 1000px; margin: auto;
            border: 1px solid rgba(255,255,255,0.2); box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }
        .main-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px; }
        .card { background: rgba(0, 0, 0, 0.4); border-radius: 20px; padding: 20px; border: 1px solid rgba(255,255,255,0.1); text-align: center; }
        
        /* ‡∏´‡∏•‡∏≠‡∏î‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÑ‡∏•‡πà‡∏™‡∏µ */
        .temp-meter {
            width: 35px; height: 150px; background: #222; border-radius: 20px;
            margin: 10px auto; border: 2px solid #444; position: relative; overflow: hidden;
        }
        #temp-fill {
            position: absolute; bottom: 0; width: 100%; height: 0%;
            background: linear-gradient(to top, #39ff14, #ffaa00, #ff0055); /* ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß-‡∏™‡πâ‡∏°-‡πÅ‡∏î‡∏á */
            box-shadow: 0 0 15px #ffaa00; transition: height 1s;
        }

        .val-text { font-size: 2.5rem; font-weight: 700; color: var(--neon-blue); }
        .status-pill { padding: 5px 15px; border-radius: 50px; font-weight: bold; margin-top: 10px; display: inline-block; }
        .normal { border: 1px solid var(--neon-green); color: var(--neon-green); }
        .alert { border: 1px solid var(--neon-red); color: var(--neon-red); animation: blink 1s infinite; }

        /* ‡∏Å‡∏£‡∏≤‡∏ü */
        .chart-container { background: rgba(0,0,0,0.5); border-radius: 20px; padding: 20px; margin-top: 20px; }
        
        /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• */
        .log-container { margin-top: 20px; background: rgba(255,255,255,0.05); border-radius: 20px; padding: 20px; max-height: 200px; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
        th { border-bottom: 1px solid #666; padding: 10px; color: var(--neon-blue); }
        td { padding: 8px; border-bottom: 1px solid #333; text-align: center; }

        @keyframes blink { 50% { opacity: 0.3; } }
    </style>
</head>
<body>

<div class="dashboard">
    <h2 style="text-shadow: 0 0 10px var(--neon-blue);">üè† ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞ Viewvi Smart Home</h2>
    
    <div class="main-grid">
        <div class="card">
            <div>üå°Ô∏è ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥</div>
            <div class="temp-meter"><div id="temp-fill"></div></div>
            <div class="val-text"><span id="t-val">--</span>¬∞C</div>
        </div>

        <div class="card">
            <div>üíß ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏≠‡∏≤‡∏Å‡∏≤‡∏®/‡∏î‡∏¥‡∏ô</div>
            <div class="val-text" id="h-val" style="color: #39ff14;">--%</div>
            <hr style="opacity:0.2">
            <div class="val-text" id="s-val" style="color: #ffaa00;">--%</div>
            <div style="font-size:0.8rem">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ô</div>
        </div>

        <div class="card">
            <div>üõ°Ô∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏</div>
            <div id="sec-icon" style="font-size: 3rem; margin: 15px 0;">üõ°Ô∏è</div>
            <div id="sec-status" class="status-pill normal">‡∏õ‡∏Å‡∏ï‡∏¥</div>
        </div>
    </div>

    <div class="chart-container">
        <canvas id="tempChart"></canvas>
    </div>

    <div class="log-container">
        <h4 style="margin-top:0">üìã ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h4>
        <table>
            <thead>
                <tr>
                    <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                    <th>‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥</th>
                    <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏</th>
                </tr>
            </thead>
            <tbody id="log-table">
                </tbody>
        </table>
    </div>
</div>

<script>
    const firebaseConfig = { databaseURL: "https://viewvi-3e5ef-default-rtdb.firebaseio.com" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏£‡∏≤‡∏ü
    const ctx = document.getElementById('tempChart').getContext('2d');
    const tempChart = new Chart(ctx, {
        type: 'line',
        data: { labels: [], datasets: [{ label: '‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ (¬∞C)', data: [], borderColor: '#00f2ff', tension: 0.4 }] },
        options: { scales: { y: { beginAtZero: false }, x: { ticks: { color: '#fff' } } } }
    });

    db.ref("/").on("value", (snapshot) => {
        const data = snapshot.val();
        if (data) {
            const now = new Date().toLocaleTimeString();
            
            // ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥
            const temp = data.temperature || 0;
            document.getElementById("t-val").innerText = temp;
            document.getElementById("temp-fill").style.height = Math.min((temp/50)*100, 100) + "%";

            // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô
            document.getElementById("h-val").innerText = (data.Humidity || "--") + "%";
            document.getElementById("s-val").innerText = (data.Soil || "--") + "%";

            // ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏
            const secStat = document.getElementById("sec-status");
            const isAlert = data.Security === 1;
            secStat.innerText = isAlert ? "‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥ - ‡∏û‡∏ö‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏!" : "‡∏õ‡∏Å‡∏ï‡∏¥";
            secStat.className = "status-pill " + (isAlert ? "alert" : "normal");
            document.getElementById("sec-icon").innerText = isAlert ? "‚ö†Ô∏è" : "üõ°Ô∏è";

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏£‡∏≤‡∏ü
            if (tempChart.data.labels.length > 10) {
                tempChart.data.labels.shift();
                tempChart.data.datasets[0].data.shift();
            }
            tempChart.data.labels.push(now);
            tempChart.data.datasets[0].data.push(temp);
            tempChart.update();

            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô)
            const table = document.getElementById("log-table");
            const row = table.insertRow(0);
            row.innerHTML = `<td>${now}</td><td>${temp}¬∞C</td><td>${isAlert ? '‡∏û‡∏ö‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏' : '‡∏õ‡∏Å‡∏ï‡∏¥'}</td>`;
            if (table.rows.length > 15) table.deleteRow(15);
        }
    });
</script>
</body>
</html>
